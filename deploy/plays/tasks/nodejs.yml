---
- name: Getting node source setup script
  uri:
    url: http://deb.nodesource.com/setup_8.x
    method: GET
    follow_redirects: safe
    dest: '{{ playbook_dir }}/helper_scripts/nodesource_setup.sh'
    mode: 0775

- name: Running node source setup script
  shell: '{{ playbook_dir }}/helper_scripts/nodesource_setup.sh'

- name: Install nodejs and build-essential
  apt:
    name: "{{ item }}"
    update_cache: yes
    force: yes
  with_items:
    - nodejs
    - build-essential

- name: Deleting nodesource_setup.sh
  file:
    path: "{{ item }}"
    state: absent
  with_items:
    - '{{ playbook_dir }}/helper_scripts/nodesource_setup.sh'

